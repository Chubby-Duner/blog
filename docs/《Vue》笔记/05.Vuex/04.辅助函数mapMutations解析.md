---
title: è¾…åŠ©å‡½æ•°mapMutationsè§£æ
date: 2021-08-09 09:54:55
permalink: /pages/c3cebb/
categories:
  - ã€ŠVueã€‹ç¬”è®°
  - Vuex
tags:
  - Vuex
author:
  name: æ€§æ„Ÿdeå°è‚¥çŒ«
---

## ä»‹ç»
ä¹‹å‰æˆ‘ä»¬å·²ç»å®Œæ•´ä»‹ç»äº†æ•´ä¸ªVuex, å›çœ‹å¯ä»¥ç‚¹å‡»æ–‡æœ«çš„`å‹æƒ…é“¾æ¥`è¿›è¡ŒæŸ¥çœ‹ã€‚

mapMutationsæ˜¯Vuexçš„mutationçš„`è¾…åŠ©å‡½æ•°`ï¼Œç”¨äºåœ¨ç»„ä»¶ä¸­æ˜ å°„mutationå†…çš„æ–¹æ³•ï¼Œä»¥ä¾¿åœ¨è¯¥ç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨mutationé‡Œçš„æ–¹æ³• (è¯­æ³•ç³–)
## ä½¿ç”¨æ­¥éª¤
### 1.åœ¨ç»„ä»¶ä¸­å¯¼å…¥vuexä¸­çš„mapMutations
```js
import { mapMutations } from 'vuex'
```
### 2.åœ¨ç»„ä»¶ä¸­å¯¼å…¥mutationé‡Œçš„æ–¹æ³•å
```js
...mapMutations([   //ä½¿ç”¨es6çš„æ‹“å±•è¿ç®—ç¬¦
        'INCREASE_SHOPCART',   
        'DECREASE_SHOPCART'   
   ]) 
```
è¿™ä¸€æ­¥ï¼Œæ˜¯å°†mutationé‡Œçš„å‡½æ•°æ˜ å°„åˆ°ç»„ä»¶é‡Œï¼Œåœ¨ç»„ä»¶é‡Œ ï¼š
```js
this.INCREASE_SHOPCART === this.$store.commit('INCREASE_SHOPCART') //true
```
åœ¨æœ‰å‚æ•°çš„æƒ…å†µä¸‹ï¼Œmutationçš„stateé»˜è®¤å‚æ•°å¯ä»¥çœç•¥ ï¼š
```js
this.INCREASE_SHOPCART(id) === this.$store.commit('INCREASE_SHOPCART',id) //true
```

ç»„ä»¶ä¸­ä½¿ç”¨ `this.$store.commit('xxx')` æäº¤ mutationï¼Œæˆ–è€…ä½¿ç”¨ mapMutations è¾…åŠ©å‡½æ•°å°†ç»„ä»¶ä¸­çš„ methods æ˜ å°„ä¸º `store.commit` è°ƒç”¨ï¼ˆéœ€è¦åœ¨æ ¹èŠ‚ç‚¹æ³¨å…¥ storeï¼‰ã€‚
> å…³äºæ˜ å°„å®˜ç½‘ä¹Ÿæœ‰ç›¸å…³çš„ä»‹ç»è¯´æ˜ --> [Mutation](https://vuex.vuejs.org/zh/guide/mutations.html)
### 3ã€ä¸¾ä¸ª(çƒ­è¾£è¾£)çš„æ —å­ğŸŒ° ï¼šç‚¹å‡»btnæŒ‰é’®å¢å‡å•†å“æ•°é‡
#### 3.1 mutations

```js
//mutations.js
INCREASE_SHOPCART(state,id){
    state.shopCartData.forEach(e=>{
      if(e.id === id){
        e.count ++
      }
    })
},
DECREASE_SHOPCART(state,id){
    state.shopCartData.forEach(e=>{
        if(e.id === id && e.count >1){
            e.count --
        }
    })
}
```
#### 3.2 ç»„ä»¶é‡Œçš„methods
å¦‚æœå¯¹ä½¿ç”¨æ–¹æ³•æœ‰ç–‘é—®å¯ä»¥çœ‹ä¹‹å‰çš„æ–‡ç« ï¼š[Vuexçš„ä½¿ç”¨](url)ï¼Œé‡Œé¢æœ‰ä»‹ç»ã€‚

```js
import { mapMutations } from 'vuex' // å…ˆä»vuexé‡Œå¯¼å…¥ mapMutations
methods:{
     ...mapMutations([  
        'INCREASE_SHOPCART', //å°†mutationé‡Œçš„æ–¹æ³•æ˜ å°„åˆ°è¯¥ç»„ä»¶å†…
        'DECREASE_SHOPCART'  //ç­‰åŒäºthis.$store.commit('DECREASE_SHOPCART')  
      ]),
     increase(id){
        //ç”±äºä¸Šä¸€æ­¥å·²ç»å°†mutationæ˜ å°„åˆ°ç»„ä»¶å†…ï¼Œæ‰€ä»¥ç»„ä»¶å¯ä»¥ç›´æ¥è°ƒç”¨INCREASE_SHOPCART  
        this.INCREASE_SHOPCART(id)
     }
     decrease(id){
        this.DECREASE_SHOPCART(id)
     }
}
```
#### 3.3 Vueæ–‡ä»¶
æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒç”¨methodsé‡Œå®šä¹‰çš„æ–¹æ³•å³å¯

```js
//Cart.vue 
<template>
  <button @click='decrease(item.id)'>-</button>
  <input type="number" class="fl" v-model="item.count">
  <button @click='increase(item.id)'>+</button>
<template>
```
## æ€»ç»“
ä¸»è¦ä»‹ç»ä½¿ç”¨`mapMutations`è¾…åŠ©å‡½æ•°ï¼Œå†…éƒ¨å°†`mutation`é‡Œçš„æ–¹æ³•æ˜ å°„åˆ°è¯¥ç»„ä»¶å†…ï¼Œç›¸æ¯”ä½¿ç”¨`this.$store.commit('xxx')`æ›´ä¸ºä¹‹æ–¹ä¾¿ä¸€ç‚¹ã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰`mapState`, `mapActions`, ç”¨æ³•ä¹Ÿç±»ä¼¼ã€‚åœ¨ç³»åˆ—(ä¸€) -- `Vuexçš„ä½¿ç”¨`ä¸­çš„æ¯ä¸ªæ ¸å¿ƒæ¦‚å¿µéƒ½ä»‹ç»äº†è¾…åŠ©å‡½æ•°çš„ç”¨æ³•ï¼Œåˆæˆ–è€…å¯èƒ½ç§»æ­¥åˆ°å®˜ç½‘æŸ¥çœ‹æ›´è¯¦ç»†çš„ä»‹ç»å–” --> [Vuexå®˜ç½‘](https://vuex.vuejs.org/zh/)

## CodeSandbox
[ CodeSandboxåœ¨çº¿ä»£ç æ¼”ç¤º](https://codesandbox.io/s/eager-rain-yvitg?file=/src/components/HelloWorld.vue)

**æ³¨æ„** å¦‚é‡åˆ°CodeSandBoxæ‰“å¼€å¤±è´¥ï¼Œè¯·å°è¯•æŒ‰ä¸‹å›¾æ“ä½œï¼Œç„¶ååˆ†çª—å£å°±èƒ½ä¸€è¾¹çœ‹ä»£ç ä¸€è¾¹çœ‹æ•ˆæœå•¦
![sandbox](https://cdn.jsdelivr.net/gh/Chubby-Duner/image-hosting@master/vuex/sandbox.png)
